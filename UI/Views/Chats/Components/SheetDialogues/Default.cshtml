@using Humanizer
@model Messenger

@if (Model?.Dialogs?.Count > 0)
{
    foreach (var dialog in Model.Dialogs)
    {
        <div name="dialogue" onclick="goToChatFromSheetDialogues(event)" class="accordion-body-item rounded w-100 p-2 row"
             data-id-interlocutor="@dialog.IdInterlocutor">
            <div class="accordion-body-image-info-block col-4 d-flex justify-content-start align-items-center pe-0">
                <img name="interlocutorAvatar" src="@dialog.Avatar" alt="No person" class="accordion-body-image rounded me-2">
                <p name="interlocutorName" class="accordion-body-text text-start">@dialog.UserName</p>
            </div>
            <div class="accordion-body-icons-block col-5 d-flex justify-content-center align-items-center p-0">
                <div class="col-6">
                    <p class="accordion-body-text">@dialog.IdInterlocutor</p>
                </div>
                <span name="bookmark" class="accordion-body-text" onchange="changeBookmark(this)">
                    @if (dialog.IsBookmarked)
                    {
                        <input type="checkbox" checked class="accordion_star_svg_checkbox opacity-0" id="@($"bookmarked-checkbox-{ViewData["criteria"]}-{Model.SheetId}-{dialog.IdInterlocutor}")" name="status-checkbox" value="yes" wfd-id="id3">
                    }
                    else
                    {
                        <input type="checkbox" class="accordion_star_svg_checkbox opacity-0" id="@($"bookmarked-checkbox-{ViewData["criteria"]}-{Model.SheetId}-{dialog.IdInterlocutor}")" name="status-checkbox" value="yes" wfd-id="id3">
                    }
                    <label for="@($"bookmarked-checkbox-{ViewData["criteria"]}-{Model.SheetId}-{dialog.IdInterlocutor}")" class="status-icon-text" title="Букмарк">
                        <svg width="24" height="24" id="AreaSVG">
                            <use xlink:href="#Star"></use>
                        </svg>
                    </label>
                </span>

                <span name="premium" class="accordion-body-text" onchange="changePremium(this)">
                    @if (dialog.IsPremium)
                    {
                        <input type="checkbox" checked class="accordion_heart_svg_checkbox opacity-0" id="@($"premium-checkbox-{ViewData["criteria"]}-{Model.SheetId}-{dialog.IdInterlocutor}")" name="status-checkbox" value="yes" wfd-id="id4">
                    }
                    else
                    {
                        <input type="checkbox" class="accordion_heart_svg_checkbox opacity-0" id="@($"premium-checkbox-{ViewData["criteria"]}-{Model.SheetId}-{dialog.IdInterlocutor}")" name="status-checkbox" value="yes" wfd-id="id4">
                    }
                    <label for="@($"premium-checkbox-{ViewData["criteria"]}-{Model.SheetId}-{dialog.IdInterlocutor}")" class="status-icon-text" title="Премиум">
                        <svg width="24" height="24" id="RiverSVG">
                            <use xlink:href="#Heart"></use>
                        </svg>
                    </label>
                </span>
            </div>
            <div class="accordion-body-time-block col-3 d-flex align-items-center">
                <p class="large-block__body-item-small-text">
                    @dialog.DateUpdated.Humanize()
                </p>
            </div>
        </div>
    }
}
else
{
    @*    <div class="accordion-body-item rounded w-100 p-2 justify-content-between align-items-center text-center">
        Нет диалогов
    </div>*@
}

@if (!string.IsNullOrWhiteSpace(Model.Cursor))
{
    <div id="@($"btn-loading-dialogues-{ViewData["criteria"]}-{Model.SheetId}")" name="btn-loading-dialogues" class="accordion-body-item rounded w-100 p-2 justify-content-between align-items-center text-center">
        <button type="button" class="btn answer-button chat-button rounded text-white" onclick="getDialogues(@Model.SheetId, '@ViewData["criteria"]', '@Model.Cursor')">
            <span class="answer-button__text">Загрузить диалоги</span>
        </button>
    </div>
}